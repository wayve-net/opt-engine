[
    "import os\nimport pathlib\nimport sys\n\nfrom setuptools import Extension, setup\n\nif sys.version_info < (3, 9):\n    raise RuntimeError(\"aiohttp 4.x requires Python 3.9+\")\n\n\nUSE_SYSTEM_DEPS = bool(\n    os.environ.get(\"AIOHTTP_USE_SYSTEM_DEPS\", os.environ.get(\"USE_SYSTEM_DEPS\"))\n)\nNO_EXTENSIONS: bool = bool(os.environ.get(\"AIOHTTP_NO_EXTENSIONS\"))\nHERE = pathlib.Path(__file__).parent\nIS_GIT_REPO = (HERE / \".git\").exists()\n\n\nif sys.implementation.name != \"cpython\":\n    NO_EXTENSIONS = True\n\n\nif (\n    not USE_SYSTEM_DEPS\n    and IS_GIT_REPO\n    and not (HERE / \"vendor/llhttp/README.md\").exists()\n):\n    print(\"Install submodules when building from git clone\", file=sys.stderr)\n    print(\"Hint:\", file=sys.stderr)\n    print(\"  git submodule update --init\", file=sys.stderr)\n    sys.exit(2)\n\n\n# NOTE: makefile cythonizes all Cython modules\n\nif USE_SYSTEM_DEPS:\n    import shlex\n\n    import pkgconfig\n\n    llhttp_sources = []\n    llhttp_kwargs = {\n        \"extra_compile_args\": shlex.split(pkgconfig.cflags(\"libllhttp\")),\n        \"extra_link_args\": shlex.split(pkgconfig.libs(\"libllhttp\")),\n    }\nelse:\n    llhttp_sources = [\n        \"vendor/llhttp/build/c/llhttp.c\",\n        \"vendor/llhttp/src/native/api.c\",\n        \"vendor/llhttp/src/native/http.c\",\n    ]\n    llhttp_kwargs = {\n        \"define_macros\": [(\"LLHTTP_STRICT_MODE\", 0)],\n        \"include_dirs\": [\"vendor/llhttp/build\"],\n    }\n\nextensions = [\n    Extension(\"aiohttp._websocket.mask\", [\"aiohttp/_websocket/mask.c\"]),\n    Extension(\n        \"aiohttp._http_parser\",\n        [\n            \"aiohttp/_http_parser.c\",\n            \"aiohttp/_find_header.c\",\n            *llhttp_sources,\n        ],\n        **llhttp_kwargs,\n    ),\n    Extension(\"aiohttp._http_writer\", [\"aiohttp/_http_writer.c\"]),\n    Extension(\"aiohttp._websocket.reader_c\", [\"aiohttp/_websocket/reader_c.c\"]),\n]\n\n\nbuild_type = \"Pure\" if NO_EXTENSIONS else \"Accelerated\"\nsetup_kwargs = {} if NO_EXTENSIONS else {\"ext_modules\": extensions}\n\nprint(\"*********************\", file=sys.stderr)\nprint(\"* {build_type} build *\".format_map(locals()), file=sys.stderr)\nprint(\"*********************\", file=sys.stderr)\nsetup(**setup_kwargs)\n"
]